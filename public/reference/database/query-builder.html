<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Routing</title>
  <meta name="description" content="A typical route accepts the route pattern as the first argument and route handler as the second argument. For example:">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="">
  <meta property="og:type" content="">
  <meta property="og:url" content="">
  <meta property="og:image" content="">

  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/site.webmanifest">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="shortcut icon" href="/icons/favicon.ico">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-config" content="/icons/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">

  <meta name="turbo-cache-control" content="no-cache">

  <link
    rel="preload"
    href="/assets/fonts/UntitledSans-RegularItalic.2c343d99.woff2"
    as="font"
    type="font/woff2" crossorigin
  >
  <link
    rel="preload"
    href="/assets/fonts/UntitledSans-Regular.f7547efa.woff2"
    as="font"
    type="font/woff2"
    crossorigin
  >
  <link
    rel="preload"
    href="/assets/fonts/UntitledSans-Medium.4adc0df5.woff2"
    as="font"
    type="font/woff2"
    crossorigin
  >
  <link
    rel="preload"
    href="/assets/fonts/JetBrainsMono-Regular.5eea635b.woff2"
    as="font"
    type="font/woff2"
    crossorigin
  >
<link rel="stylesheet" href="/assets/app.6c0c2135.css" />
<script src="/assets/342.70de04a2.js" defer></script>
<script src="/assets/app.26949583.js" defer></script>
</head>

<body><div class="header-wrapper">
  <header class="header">
    <div class="header-container">

      <div class="primary-links"><a href="#sidenav-open" title="Open Docs Menu" aria-label="Open Docs Menu" class="hamburger for-mobile" data-turbo="false">
  <svg role="presentation" focusable="false" aria-label="Icon for open menu" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
    <line x1="4" y1="6" x2="20" y2="6" />
    <line x1="4" y1="12" x2="20" y2="12" />
    <line x1="4" y1="18" x2="20" y2="18" />
  </svg>
</a>

<div class="logo-wrapper">
  <a href="https://adonisjs.com" title="AdonisJS website" target="_blank" rel="noopener">
    <span class="for-mobile">
      <svg width="68" height="17" viewBox="0 0 68 17" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M54.6867 0C53.54 0 52.7119 0.812178 52.7119 1.94286C52.7119 3.07354 53.54 3.88571 54.6867 3.88571C55.8333 3.88571 56.6614 3.07354 56.6614 1.94286C56.6614 0.812178 55.8333 0 54.6867 0ZM18.5686 16.6895C15.511 16.6895 13.2974 14.4286 13.2974 10.8927C13.2974 7.29317 15.511 5.03232 18.5686 5.03232C19.9859 5.03232 21.037 5.51007 21.6581 6.44965V0.509602H24.8431V16.4347H21.6581V15.304C21.0529 16.2276 20.0019 16.6895 18.5686 16.6895ZM16.5461 10.8927C16.5461 8.91803 17.6131 7.6281 19.2375 7.6281C20.8778 7.6281 21.9288 8.90211 21.9288 10.8768C21.9288 12.8197 20.8778 14.0778 19.2375 14.0778C17.6131 14.0778 16.5461 12.8197 16.5461 10.8927ZM29.8436 10.8609C29.8436 8.90211 30.9105 7.64403 32.503 7.64403C34.1115 7.64403 35.1785 8.90211 35.1785 10.8609C35.1785 12.8197 34.1115 14.0778 32.503 14.0778C30.9105 14.0778 29.8436 12.8197 29.8436 10.8609ZM64.9424 13.393C64.9424 13.9822 64.4965 14.3326 63.3658 14.3326C62.0918 14.3326 61.2956 13.6637 61.2956 12.8515H58.1105C58.1902 15.0492 60.2763 16.6895 63.3021 16.6895C66.1686 16.6895 68 15.4155 68 13.1541C68 11.466 66.9171 10.2876 64.7672 9.85761L62.4581 9.39578C61.7574 9.25246 61.3433 8.90211 61.3433 8.44028C61.3433 7.7555 62.044 7.38923 62.9358 7.38923C64.2098 7.38923 64.7035 7.97845 64.7035 8.67916H67.7293C67.6497 6.6089 66.0253 5.03232 62.9995 5.03232C60.1808 5.03232 58.2698 6.44965 58.2698 8.59953C58.2698 10.5424 59.5279 11.4183 61.407 11.8164L63.7002 12.3101C64.4487 12.4693 64.9424 12.7878 64.9424 13.393ZM53.1101 5.28712H56.2951V16.4347H53.1101V5.28712ZM43.3639 5.28712V6.44965C44.1761 5.51007 45.259 5.03232 46.5967 5.03232C49.097 5.03232 50.7213 6.65667 50.7213 9.17283V16.4347H47.5363V9.84169C47.5363 8.48806 46.7719 7.67588 45.4501 7.67588C44.1283 7.67588 43.3639 8.48806 43.3639 9.84169V16.4347H40.1789V5.28712H43.3639ZM32.503 5.03232C29.111 5.03232 26.5948 7.48478 26.5948 10.8609C26.5948 14.237 29.111 16.6895 32.503 16.6895C35.911 16.6895 38.4272 14.237 38.4272 10.8609C38.4272 7.48478 35.911 5.03232 32.503 5.03232ZM5.94005 7.6281C4.31569 7.6281 3.24871 8.91803 3.24871 10.8927C3.24871 12.8197 4.31569 14.0778 5.94005 14.0778C7.58033 14.0778 8.63138 12.8197 8.63138 10.8768C8.63138 8.90211 7.58033 7.6281 5.94005 7.6281ZM0 10.8927C0 14.4286 2.21358 16.6895 5.25527 16.6895C6.70445 16.6895 7.73958 16.2276 8.36066 15.304V16.4347H11.5457V5.28712H8.36066V6.44965C7.72365 5.51007 6.6726 5.03232 5.25527 5.03232C2.21358 5.03232 0 7.29317 0 10.8927Z" fill="white"/>
      </svg>
    </span>

    <span class="for-desktop">
      <svg width="108" height="36" viewBox="0 0 108 36" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M0 16.3331C0 29.506 3.16017 32.6662 16.3331 32.6662C29.506 32.6662 32.6662 29.506 32.6662 16.3331C32.6662 3.16017 29.506 0 16.3331 0C3.16017 0 0 3.16017 0 16.3331ZM6.58646 19.7261L11.7093 8.08338C12.5742 6.12075 14.2374 5.05627 16.3331 5.05627C18.4288 5.05627 20.092 6.12075 20.9569 8.08338L26.0797 19.7261C26.3126 20.2916 26.5122 21.0235 26.5122 21.6555C26.5122 24.5495 24.483 26.5787 21.589 26.5787C20.6032 26.5787 19.8203 26.3271 19.0278 26.0725C18.2158 25.8116 17.3937 25.5475 16.3331 25.5475C15.2847 25.5475 14.4426 25.814 13.6145 26.076C12.8136 26.3294 12.0258 26.5787 11.0772 26.5787C8.18318 26.5787 6.15402 24.5495 6.15402 21.6555C6.15402 21.0235 6.35361 20.2916 6.58646 19.7261ZM16.3331 10.1125L11.2768 21.5557C12.7737 20.8571 14.5035 20.5245 16.3331 20.5245C18.0961 20.5245 19.8924 20.8571 21.3228 21.5557L16.3331 10.1125Z" fill="white"></path>
        <path fill-rule="evenodd" clip-rule="evenodd" d="M94.0883 8.03894C92.9542 8.03894 92.1352 8.84223 92.1352 9.96054C92.1352 11.0788 92.9542 11.8821 94.0883 11.8821C95.2223 11.8821 96.0414 11.0788 96.0414 9.96054C96.0414 8.84223 95.2223 8.03894 94.0883 8.03894ZM58.3654 24.5458C55.3413 24.5458 53.1519 22.3097 53.1519 18.8125C53.1519 15.2523 55.3413 13.0162 58.3654 13.0162C59.7673 13.0162 60.8068 13.4887 61.4211 14.418V8.54297H64.5713V24.2938H61.4211V23.1755C60.8226 24.089 59.783 24.5458 58.3654 24.5458ZM56.3651 18.8125C56.3651 16.8594 57.4204 15.5836 59.027 15.5836C60.6493 15.5836 61.6889 16.8436 61.6889 18.7967C61.6889 20.7183 60.6493 21.9627 59.027 21.9627C57.4204 21.9627 56.3651 20.7183 56.3651 18.8125ZM69.517 18.781C69.517 16.8436 70.5723 15.5993 72.1474 15.5993C73.7382 15.5993 74.7935 16.8436 74.7935 18.781C74.7935 20.7183 73.7382 21.9627 72.1474 21.9627C70.5723 21.9627 69.517 20.7183 69.517 18.781ZM104.232 21.2854C104.232 21.8681 103.791 22.2147 102.672 22.2147C101.412 22.2147 100.625 21.5531 100.625 20.7498H97.4747C97.5535 22.9235 99.6168 24.5458 102.609 24.5458C105.445 24.5458 107.256 23.2857 107.256 21.0491C107.256 19.3795 106.185 18.214 104.059 17.7887L101.775 17.3319C101.082 17.1902 100.672 16.8436 100.672 16.3869C100.672 15.7096 101.365 15.3473 102.247 15.3473C103.507 15.3473 103.996 15.9301 103.996 16.6231H106.988C106.909 14.5755 105.303 13.0162 102.31 13.0162C99.5223 13.0162 97.6322 14.418 97.6322 16.5444C97.6322 18.466 98.8765 19.3323 100.735 19.726L103.003 20.2143C103.744 20.3718 104.232 20.6868 104.232 21.2854ZM95.6791 24.2938H92.5289V13.2682H95.6791V24.2938ZM82.8895 13.2682V14.418C83.6927 13.4887 84.7638 13.0162 86.0869 13.0162C88.5597 13.0162 90.1663 14.6228 90.1663 17.1114V24.2938H87.0162V17.7729C87.0162 16.4341 86.2601 15.6308 84.9528 15.6308C83.6455 15.6308 82.8895 16.4341 82.8895 17.7729V24.2938H79.7393V13.2682H82.8895ZM72.1474 13.0162C68.7925 13.0162 66.3039 15.4418 66.3039 18.781C66.3039 22.1202 68.7925 24.5458 72.1474 24.5458C75.5181 24.5458 78.0067 22.1202 78.0067 18.781C78.0067 15.4418 75.5181 13.0162 72.1474 13.0162ZM45.8751 15.5836C44.2685 15.5836 43.2132 16.8594 43.2132 18.8125C43.2132 20.7183 44.2685 21.9627 45.8751 21.9627C47.4974 21.9627 48.5369 20.7183 48.5369 18.7967C48.5369 16.8436 47.4974 15.5836 45.8751 15.5836ZM40 18.8125C40 22.3097 42.1894 24.5458 45.1978 24.5458C46.6311 24.5458 47.6549 24.089 48.2692 23.1755V24.2938H51.4193V13.2682H48.2692V14.418C47.6391 13.4887 46.5996 13.0162 45.1978 13.0162C42.1894 13.0162 40 15.2523 40 18.8125Z" fill="white"></path>
      </svg>
    </span>
  </a>
</div>

      </div>

      <nav class="header-nav">
        <ul>


                <li class="">
                  <a href="/guides/context">
                    Docs
                  </a>
                  <ul>
                  </ul>
                </li>

              <li
                class="active"
                x-data="{ active: false }"
                :class="{ 'expand': active }"
              >
                <a href="#" @click.prevent="active = !active">
                  Reference guides
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-down" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                    <polyline points="6 9 12 15 18 9" />
                  </svg>
                </a>
                <ul class="dropdown">
                    <li>
                      <a href="/reference/database/connection">Database</a>
                    </li>
                    <li>
                      <a href="/reference/validator/schema/string">Validator</a>
                    </li>
                    <li>
                      <a href="/reference/views/globals/inspect">Views &amp; Templates</a>
                    </li>
                </ul>
              </li>
        </ul>
      </nav>

      <div class="search-wrapper">
        <button class="search-trigger" title="Open search popup" aria-label="Open search popup">
          <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" aria-hidden="true">
            <path d="M0 0h24v24H0z" fill="none"></path>
            <path fill="currentColor" d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
          </svg>
          <span class="text"> Search... </span>
        </button>
      </div>
    </div>
  </header>
</div>

<div id="sidenav-open">
  <div class="sidebar" id="sidebar" data-maintain-scroll>
    <div class="sidebar-container">





                <nav>
                  <ol>
                      <li
                        class=""
                      >
                        <a href="/reference/database/connection"> Connection </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/database/connection-manager"> Connection manager </a>
                      </li>
                      <li
                        class="active"
                      >
                        <a href="/reference/database/query-builder"> Query builder </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/database/insert-query-builder"> Insert query builder </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/database/raw-query-builder"> Raw query builder </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/database/reference-builder"> Reference builder </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/database/query-client"> Query client </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/database/transaction-client"> Transaction client </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/database/main"> Database </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/database/schema"> Schema </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/database/schema-builder"> Schema builder </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/database/table-builder"> Table builder </a>
                      </li>
                  </ol>
                </nav>
                <nav>
                    <h3> ORM </h3>
                  <ol>
                      <li
                        class=""
                      >
                        <a href="/reference/orm/base-model"> Base Model </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/orm/naming-strategy"> Naming strategy </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/orm/query-builder"> Query builder </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/orm/decorators"> Decorators </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/orm/adapter"> Adapter </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/orm/preloader"> Preloader </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/orm/model-factories"> Models factories </a>
                      </li>
                  </ol>
                </nav>
                <nav>
                    <h3> Relationships </h3>
                  <ol>
                      <li
                        class=""
                      >
                        <a href="/reference/orm/relations/has-one"> Has One </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/orm/relations/has-many"> Has Many </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/orm/relations/belongs-to"> Belongs To </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/orm/relations/many-to-many"> Many to Many </a>
                      </li>
                      <li
                        class=""
                      >
                        <a href="/reference/orm/relations/has-many-through"> Has many through </a>
                      </li>
                  </ol>
                </nav>


    </div>
  </div>

  <a href="#" data-turbo="false" id="sidenav-close" class="sidenav-backdrop" title="Close Docs Menu" aria-label="Close Docs Menu"></a>
</div>

<main class="doc" data-turbo="false">
  <div class="markdown">
    <h1>Query builder</h1><p>The Database query builder is used to construct <strong>select</strong>, <strong>update</strong> and <strong>delete</strong> SQL queries. For inserting new rows you must use the <a
  href=""
  
  
>insert query builder</a>
 and use <a
  href=""
  
  
>raw query builder</a>
 for running raw SQL queries.</p>
<p>You can get an instance of the database query builder using one of the following methods.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #89DDFF;">import</span><span style="color: #A6ACCD;"> Database </span><span style="color: #89DDFF;">from</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">@ioc:Adonis/Lucid/Database</span><span style="color: #89DDFF;">&#x27;</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">query</span><span style="color: #A6ACCD;">()</span></div><div class="line"></div><div class="line"><span style="color: #676E95;">// selecting table returns the query builder instance as well</span></div><div class="line"><span style="color: #A6ACCD;">Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<h2 id="select"><a
  href="#select"
  
  
><span class="icon icon-link"></span></a>
select</h2>
<p>The <code>select</code> method allows selecting columns from the database table.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">username</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">email</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>You can define aliases for the columns using the <code>as</code> expression or by passing an object of key-value pair.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">email as userEmail</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>In the following example, the object key is the alias and value is the column real name.</p>
<div class="alert alert-tip"><p>Chaining the <code>select</code> method will append to the existing set of selected columns. You can make use of <code>clearSelect</code> method to remove previously selected columns.</p></div>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #F07178;">userEmail</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">email</span><span style="color: #89DDFF;">&#x27;</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>Also, you can make use of sub-queries and raw-queries for generating columns at runtime. For example, selecting the last login ip address for a user from the <code>user_logins</code> table.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span></div><div class="line"><span style="color: #A6ACCD;">    Database</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_logins</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">ip_address</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereColumn</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users.id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_logins.user_id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">orderBy</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">desc</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">limit</span><span style="color: #A6ACCD;">(</span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">as</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">last_login_ip</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  )</span></div></code></pre>
</div>

<p>Similar to a sub-query, you can pass an instance of the raw query as well.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span></div><div class="line"><span style="color: #A6ACCD;">    Database</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">raw</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x60;</span></div><div class="line"><span style="color: #C3E88D;">        (select ip_address from user_logins where users.id = user_logins.user_id limit 1) as last_login_ip</span></div><div class="line"><span style="color: #C3E88D;">      </span><span style="color: #89DDFF;">&#x60;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  )</span></div></code></pre>
</div>

<h2 id="from"><a
  href="#from"
  
  
><span class="icon icon-link"></span></a>
from</h2>
<p>The <code>from</code> method is used to define the database table for the query.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>The query builder also allows using derived tables by passing a sub-query or a closure (which acts like a sub-query).</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">subquery</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">  </span><span style="color: #A6ACCD;">subquery</span></div><div class="line"><span style="color: #F07178;">    </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_exams</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">    </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">sum</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">marks as total</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">    </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">groupBy</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">    </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">as</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">total_marks</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">avg</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">total_marks.total</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<h2 id="where"><a
  href="#where"
  
  
><span class="icon icon-link"></span></a>
where</h2>
<p>The <code>where</code> method is used to define the where clause in your SQL queries. The query builder accepts a wide range of arguments types to let you leverage SQL complete power.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">username</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">virk</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>You can also define SQL operators as follows:</p>
<div class="alert alert-tip"><p>You can also use <code>luxon</code> date time objects. Just make sure to format them using the <code>toSQLDate</code> method.</p><div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">created_at</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">&gt;</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> DateTime</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">local</span><span style="color: #A6ACCD;">()</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">toSQLDate</span><span style="color: #A6ACCD;">())</span></div></code></pre>
</div>
</div>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #89DDFF;">return</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">created_at</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">&gt;</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">2020-09-09</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<h4 id="wrapping-where-clause"><a
  href="#wrapping-where-clause"
  
  
><span class="icon icon-link"></span></a>
Wrapping where clause</h4>
<p>You can pass a callback to the <code>where</code> method in order to wrap the where condition inside a callback. For example:</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">    </span><span style="color: #A6ACCD;">query</span></div><div class="line"><span style="color: #F07178;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">username</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #F07178;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">virk</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereNull</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">deleted_at</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">  </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">orWhere</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">    </span><span style="color: #A6ACCD;">query</span></div><div class="line"><span style="color: #F07178;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">email</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #F07178;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">virk@adonisjs.com</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereNull</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">deleted_at</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">  </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div><div class="line"></div><div class="line"><span style="color: #676E95;">/*</span></div><div class="line"><span style="color: #676E95;">SELECT * FROM &quot;users&quot;</span></div><div class="line"><span style="color: #676E95;">  WHERE (</span></div><div class="line"><span style="color: #676E95;">    &quot;username&quot; = ? AND &quot;deleted_at&quot; IS NULL</span></div><div class="line"><span style="color: #676E95;">  )</span></div><div class="line"><span style="color: #676E95;">  or (</span></div><div class="line"><span style="color: #676E95;">    &quot;email&quot; = ? AND &quot;deleted_at&quot; IS NULL</span></div><div class="line"><span style="color: #676E95;">  )</span></div><div class="line"><span style="color: #676E95;">*/</span></div></code></pre>
</div>

<h4 id="using-sub-queries-and-raw-queries"><a
  href="#using-sub-queries-and-raw-queries"
  
  
><span class="icon icon-link"></span></a>
Using sub queries and raw queries</h4>
<p>The <code>where</code> method value can also be a sub-query.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereIn</span><span style="color: #A6ACCD;">(</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">    Database</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_logins</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">created_at</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">&lt;</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">2020-09-09</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  )</span></div></code></pre>
</div>

<p>Similarly you can also define a raw query.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereIn</span><span style="color: #A6ACCD;">(</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">    Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">raw</span><span style="color: #A6ACCD;">(</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">(select &quot;user_id&quot; from &quot;user_logins&quot; where &quot;created_at&quot; &lt; ?)</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">      [</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">2020-09-09</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">]</span></div><div class="line"><span style="color: #A6ACCD;">    )</span></div><div class="line"><span style="color: #A6ACCD;">  )</span></div></code></pre>
</div>

<p>The following variations of the <code>where</code> method follows the same API.</p>
<ul>
<li><code>andWhere</code>: Alias for the <code>where</code> method</li>
<li><code>orWhere</code>: Adds an <strong>or where</strong> clause</li>
<li><code>whereNot</code>: Adds a <strong>where not</strong> clause</li>
<li><code>orWhereNot</code>: Adds an <strong>or where not</strong> clause</li>
<li><code>andWhereNot</code>: Alias for <code>whereNot</code></li>
</ul>
<h2 id="wherein"><a
  href="#wherein"
  
  
><span class="icon icon-link"></span></a>
whereIn</h2>
<p>The <code>whereIn</code> method is used to define the <strong>where in</strong> clause in your SQL queries. For example</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereIn</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> [</span><span style="color: #F78C6C;">1</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">2</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">3</span><span style="color: #A6ACCD;">])</span></div></code></pre>
</div>

<p>You can also pass a pair of columns and their corresponding values.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereIn</span><span style="color: #A6ACCD;">([</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">email</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">]</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> [</span></div><div class="line"><span style="color: #A6ACCD;">    [</span><span style="color: #F78C6C;">1</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">virk@adonisjs.com</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">]</span></div><div class="line"><span style="color: #A6ACCD;">  ])</span></div></code></pre>
</div>

<p>Similar to the <code>where</code> method the whereIn values can also be computed using a sub-query or a raw-query.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereIn</span><span style="color: #A6ACCD;">(</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">    Database</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_logins</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">created_at</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">&lt;</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">2020-09-09</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  )</span></div></code></pre>
</div>

<p>For multiple columns</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereIn</span><span style="color: #A6ACCD;">(</span></div><div class="line"><span style="color: #A6ACCD;">    [</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">email</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">]</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">    Database</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">accounts</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">email</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  )</span></div></code></pre>
</div>

<p>You can also generate a sub-query by passing a callback as the 2nd argument.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereIn</span><span style="color: #A6ACCD;">(</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #A6ACCD;"> query</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_logins</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  )</span></div></code></pre>
</div>

<p>The following variations of the <code>whereIn</code> method follows the same API.</p>
<ul>
<li><code>andWhereIn</code>: Alias for the <code>whereIn</code> method</li>
<li><code>orWhereIn</code>: Adds an <strong>or where in</strong> clause</li>
<li><code>whereNotIn</code>: Adds a <strong>where not in</strong> clause</li>
<li><code>orWhereNotIn</code>: Adds an <strong>or where not in</strong> clause</li>
<li><code>andWhereNotIn</code>: Alias for <code>whereNotIn</code></li>
</ul>
<h2 id="whereexists"><a
  href="#whereexists"
  
  
><span class="icon icon-link"></span></a>
whereExists</h2>
<p>The <code>whereExists</code> methods allows adding where constraints by checking for existence of results on a sub query. For example: Select all users who have at least logged in once.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereExists</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">    </span><span style="color: #A6ACCD;">query</span></div><div class="line"><span style="color: #F07178;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_logins</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereColumn</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users.id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #F07178;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_logins.user_id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">limit</span><span style="color: #F07178;">(</span><span style="color: #F78C6C;">1</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">  </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>You can also pass in a sub-query or a raw-query as the first argument.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereExists</span><span style="color: #A6ACCD;">(</span></div><div class="line"><span style="color: #A6ACCD;">    Database</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_logins</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereColumn</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users.id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_logins.user_id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">limit</span><span style="color: #A6ACCD;">(</span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  )</span></div></code></pre>
</div>

<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereExists</span><span style="color: #A6ACCD;">(</span></div><div class="line"><span style="color: #A6ACCD;">    Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">raw</span><span style="color: #A6ACCD;">(</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">select * from user_logins where users.id = user_logins.user_id</span><span style="color: #89DDFF;">&#x27;</span></div><div class="line"><span style="color: #A6ACCD;">    )</span></div><div class="line"><span style="color: #A6ACCD;">  )</span></div></code></pre>
</div>

<p>The <code>whereExists</code> method also has following variations.</p>
<ul>
<li><code>andWhereExists</code>: Alias for the <code>whereExists</code> method</li>
<li><code>orWhereExists</code>: Adds an <strong>or where exists</strong> clause</li>
<li><code>whereNotExists</code>: Adds a <strong>where not exists</strong> clause</li>
<li><code>orWhereNotExists</code>: Adds an <strong>or where not exists</strong> clause</li>
<li><code>andWhereNotExists</code>: Alias for the <code>whereNotExists</code> method</li>
</ul>
<h2 id="wherebetween"><a
  href="#wherebetween"
  
  
><span class="icon icon-link"></span></a>
whereBetween</h2>
<p>The <code>whereBetween</code> method adds the <strong>where between</strong> clause.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereBetween</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">age</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> [</span><span style="color: #F78C6C;">18</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">60</span><span style="color: #A6ACCD;">])</span></div></code></pre>
</div>

<p>The min and max values can be derived from other tables using sub-queries.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereBetween</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">age</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> [</span></div><div class="line"><span style="color: #A6ACCD;">    Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">participation_rules</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">min_age</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">    Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">participation_rules</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">max_age</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">  ])</span></div></code></pre>
</div>

<p>You can also make use of raw-queries for deriving values from other database tables.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereBetween</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">age</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> [</span></div><div class="line"><span style="color: #A6ACCD;">    Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">raw</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">(select min_age from participation_rules)</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">    Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">raw</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">(select max_age from participation_rules)</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">  ])</span></div></code></pre>
</div>

<p>The <code>whereBetween</code> method also has following variations.</p>
<ul>
<li><code>andWhereBetween</code>: Alias for the <code>whereBetween</code> method</li>
<li><code>orWhereBetween</code>: Adds an <strong>or where between</strong> clause</li>
<li><code>whereNotBetween</code>: Adds a <strong>where not between</strong> clause</li>
<li><code>orWhereNotBetween</code>: Adds an <strong>or where not between</strong> clause</li>
<li><code>andWhereNotBetween</code>: Alias for the <code>whereNotBetween</code> method</li>
</ul>
<h2 id="whereraw"><a
  href="#whereraw"
  
  
><span class="icon icon-link"></span></a>
whereRaw</h2>
<p>You can make use of the <code>whereRaw</code> method to express conditions not covered by the query builder standard API.</p>
<p>[warning]
Always make sure to bind parameters and do not encode user input directly in the raw query.
[/warning]</p>
<h4 id="encoding-user-values-directly-wrong"><a
  href="#encoding-user-values-directly-wrong"
  
  
><span class="icon icon-link"></span></a>
Encoding user values directly (Wrong)</h4>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereRaw</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x60;</span><span style="color: #C3E88D;">username = </span><span style="color: #89DDFF;">${</span><span style="color: #A6ACCD;">username</span><span style="color: #89DDFF;">}&#x60;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<h4 id="using-bind-params-right"><a
  href="#using-bind-params-right"
  
  
><span class="icon icon-link"></span></a>
Using bind params (Right)</h4>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereRaw</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">username = ?</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> [username])</span></div></code></pre>
</div>

<p>The <code>whereRaw</code> method also has following variations.</p>
<ul>
<li><code>andWhereRaw</code>: Alias for the <code>whereRaw</code> method</li>
<li><code>orWhereRaw</code>: Adds an <strong>or where raw</strong> clause</li>
</ul>
<h2 id="join"><a
  href="#join"
  
  
><span class="icon icon-link"></span></a>
join</h2>
<p>The <code>join</code> method allows to specify SQL joins between two tables. For example: Select user login <code>ip_address</code> and the <code>country</code>.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">join</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_logins</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users.id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">=</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_logins.user_id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users.*</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_logins.ip_address</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_logins.country</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>You can pass a callback as the 2nd argument to define more join constraints.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  .from(&#x27;users&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">  .join(&#x27;user_logins&#x27;, (query) =&gt; {</span></div><div class="line"><span style="color: #A6ACCD;">    query</span></div><div class="line"><span style="color: #A6ACCD;">      .on(&#x27;users.id&#x27;, &#x27;=&#x27;, &#x27;user_logins.user_id&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">      .andOn(&#x27;user_logins.created_at&#x27;, &#x27;&gt;&#x27;, Database.ref(&#x27;2020-10-09&#x27;))</span></div><div class="line"><span style="color: #A6ACCD;">  })</span></div><div class="line"><span style="color: #A6ACCD;">  .select(&#x27;users.*&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">  .select(&#x27;user_logins.ip_address&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">  .select(&#x27;user_logins.country&#x27;)</span></div></code></pre>
</div>

<p>[comment title=&quot;To be added later&quot;]</p>
<p>In order to group join constraints, you can pass a callback to the <code>on</code> method.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  .from(&#x27;users&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">  .join(&#x27;user_logins&#x27;, (query) =&gt; {</span></div><div class="line"><span style="color: #A6ACCD;">    query</span></div><div class="line"><span style="color: #A6ACCD;">      .on((subquery) =&gt; {</span></div><div class="line"><span style="color: #A6ACCD;">        subquery</span></div><div class="line"><span style="color: #A6ACCD;">          .on(&#x27;users.id&#x27;, &#x27;=&#x27;, &#x27;user_logins.user_id&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">          .andOn(&#x27;user_logins.created_at&#x27;, &#x27;&gt;&#x27;, Database.ref(&#x27;2020-10-09&#x27;))</span></div><div class="line"><span style="color: #A6ACCD;">      })</span></div><div class="line"><span style="color: #A6ACCD;">      .orOn((subquery) =&gt; {</span></div><div class="line"><span style="color: #A6ACCD;">        subquery</span></div><div class="line"><span style="color: #A6ACCD;">          .on(&#x27;users.id&#x27;, &#x27;=&#x27;, &#x27;user_logins.account_id&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">          .andOn(&#x27;user_logins.created_at&#x27;, &#x27;&gt;&#x27;, Database.ref(&#x27;2020-10-09&#x27;))</span></div><div class="line"><span style="color: #A6ACCD;">      })</span></div><div class="line"><span style="color: #A6ACCD;">  })</span></div><div class="line"><span style="color: #A6ACCD;">  .select(&#x27;users.*&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">  .select(&#x27;user_logins.ip_address&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">  .select(&#x27;user_logins.country&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;"></span></div><div class="line"><span style="color: #A6ACCD;">/** Output</span></div><div class="line"><span style="color: #A6ACCD;"></span></div><div class="line"><span style="color: #A6ACCD;">SELECT</span></div><div class="line"><span style="color: #A6ACCD;">  &quot;users&quot;.*,</span></div><div class="line"><span style="color: #A6ACCD;">  &quot;user_logins&quot;.&quot;ip_address&quot;,</span></div><div class="line"><span style="color: #A6ACCD;">  &quot;user_logins&quot;.&quot;country&quot;</span></div><div class="line"><span style="color: #A6ACCD;">FROM &quot;users&quot;</span></div><div class="line"><span style="color: #A6ACCD;">  INNER JOIN &quot;user_logins&quot; ON (</span></div><div class="line"><span style="color: #A6ACCD;">    &quot;users&quot;.&quot;id&quot; = &quot;user_logins&quot;.&quot;user_id&quot; AND &quot;user_logins&quot;.&quot;created_at&quot; &gt; ?</span></div><div class="line"><span style="color: #A6ACCD;">  )</span></div><div class="line"><span style="color: #A6ACCD;">  or (</span></div><div class="line"><span style="color: #A6ACCD;">    &quot;users&quot;.&quot;id&quot; = &quot;user_logins&quot;.&quot;account_id&quot; AND &quot;user_logins&quot;.&quot;created_at&quot; &gt; ?</span></div><div class="line"><span style="color: #A6ACCD;">  )</span></div><div class="line"><span style="color: #A6ACCD;">*/</span></div></code></pre>
</div>

<p>[/comment]</p>
<p>The <code>join</code> method uses the <strong>inner join</strong> by default. However, you can use one of the following methods to use a more suitable join for your query.</p>
<ul>
<li><code>leftJoin</code></li>
<li><code>leftOuterJoin</code></li>
<li><code>rightJoin</code></li>
<li><code>rightOuterJoin</code></li>
<li><code>fullOuterJoin</code></li>
<li><code>crossJoin</code></li>
</ul>
<h2 id="joinraw"><a
  href="#joinraw"
  
  
><span class="icon icon-link"></span></a>
joinRaw</h2>
<p>You can make use of the <code>joinRaw</code> method to express conditions not covered by the query builder standard API.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">joinRaw</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">natural full join user_logins</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<h2 id="on-methods"><a
  href="#on-methods"
  
  
><span class="icon icon-link"></span></a>
On methods</h2>
<p>Similar to the <code>where</code> clause, you can add the <code>on</code> clause in the join query using one of the following methods.</p>
<p>– <code>onIn</code>
– <code>onNotIn</code>
– <code>onNull</code>
– <code>onNotNull</code>
– <code>onExists</code>
– <code>onNotExists</code>
– <code>onBetween</code>
– <code>onNotBetween</code></p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">join</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_logins</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">    </span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">onIn</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_logins.country</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #F07178;"> [</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">India</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #F07178;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">US</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #F07178;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">UK</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">])</span></div><div class="line"><span style="color: #F07178;">  </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">join</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_logins</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">    </span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">onExists</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">subquery</span><span style="color: #89DDFF;">)</span><span style="color: #F07178;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #F07178;"> </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">      </span><span style="color: #A6ACCD;">subquery</span></div><div class="line"><span style="color: #F07178;">        </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">*</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">        </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">accounts</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">        </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereRaw</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users.account_id = accounts.id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">    </span><span style="color: #89DDFF;">}</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">  </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<h2 id="having"><a
  href="#having"
  
  
><span class="icon icon-link"></span></a>
having</h2>
<p>The <code>having</code> method adds the <strong>having</strong> clause. Most of the times you will find yourself using the <code>havingRaw</code> method.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  .from(&#x27;marks&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">  .select(&#x27;user_id&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">  .sum(&#x27;score as total_marks&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">  .groupBy(&#x27;user_id&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">  .havingRaw(&#x27;SUM(score) &gt; ?&#x27;, [200])</span></div></code></pre>
</div>

<p>You can use one of the following methods when the having clause does not rely on an aggregate function. Otherwise, stick to <code>havingRaw</code>.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">marks</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">groupBy</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">user_id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">having</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">total</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">&gt;</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">200</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>Following methods have the same signature as the <code>where</code> method.</p>
<p>– <code>havingIn</code>
– <code>havingNotIn</code>
– <code>havingNull</code>
– <code>havingNotNull</code>
– <code>havingExists</code>
– <code>havingNotExists</code>
– <code>havingBetween</code>
– <code>havingNotBetween</code></p>
<h2 id="distinct"><a
  href="#distinct"
  
  
><span class="icon icon-link"></span></a>
distinct</h2>
<p>The <code>distinct</code> method applies the <strong>distinct</strong> clause to the select statement.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">distinct</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">country</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>You can call the <code>distinct</code> method without any parameters to eliminate duplicate rows.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">distinct</span><span style="color: #A6ACCD;">()</span></div></code></pre>
</div>

<p>There is another PostgreSQL only method <code>distinctOn</code>. Here&#x27;s an article explaining <a
  href="https://www.geekytidbits.com/postgres-distinct-on/"
  target=&quot;_blank&quot;
  rel=&quot;noopener&quot;
>SELECT DISTINCT ON</a>
.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">logs</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">distinctOn</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">url</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">orderBy</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">created_at</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">DESC</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<h2 id="groupby"><a
  href="#groupby"
  
  
><span class="icon icon-link"></span></a>
groupBy</h2>
<p>The <code>groupBy</code> method applies the <strong>group by</strong> clause to the query.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">logs</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">url</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">groupBy</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">url</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>You can also define a raw-query with <code>groupByRaw</code> method.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">sales</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">year</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">groupByRaw</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">year WITH ROLLUP</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<h2 id="orderby"><a
  href="#orderby"
  
  
><span class="icon icon-link"></span></a>
orderBy</h2>
<p>The <code>orderBy</code> method applies the <strong>order by</strong> clause to the query.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">orderBy</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">created_at</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">desc</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>Multiple orders can be applied by calling the <code>orderBy</code> method for the multiple times.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">orderBy</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">username</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">asc</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">orderBy</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">created_at</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">desc</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>Or pass an array of objects.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">orderBy</span><span style="color: #A6ACCD;">([</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #F07178;">column</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">username</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #F07178;">order</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">asc</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">},</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #F07178;">column</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">created_at</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">      </span><span style="color: #F07178;">order</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">desc</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">}</span></div><div class="line"><span style="color: #A6ACCD;">  ])</span></div></code></pre>
</div>

<p>You can also pass a sub-query instance to the <code>orderBy</code> method. For example: Order posts by the number of comments they have received.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> commentsCountQuery </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">comments</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">count</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">*</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereColumn</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">posts.id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">=</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">comments.post_id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">posts</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">orderBy</span><span style="color: #A6ACCD;">(commentsCountQuery</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">desc</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>Finally, you can make use of the <code>orderByRaw</code> method to define the order by query from a SQL string.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> commentsCountQuery </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">raw</span><span style="color: #A6ACCD;">(</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">(select count(*) from comments where posts.id = comments.post_id)</span><span style="color: #89DDFF;">&#x27;</span></div><div class="line"><span style="color: #A6ACCD;">  )</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">posts</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">orderBy</span><span style="color: #A6ACCD;">(commentsCountQuery</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">desc</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<h2 id="offset"><a
  href="#offset"
  
  
><span class="icon icon-link"></span></a>
offset</h2>
<p>Apply offset to the SQL query</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">posts</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">offset</span><span style="color: #A6ACCD;">(</span><span style="color: #F78C6C;">11</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<h2 id="limit"><a
  href="#limit"
  
  
><span class="icon icon-link"></span></a>
limit</h2>
<p>Apply limit to the SQL query</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">posts</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">limit</span><span style="color: #A6ACCD;">(</span><span style="color: #F78C6C;">20</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<h2 id="forpage"><a
  href="#forpage"
  
  
><span class="icon icon-link"></span></a>
forPage</h2>
<p>The <code>forPage</code> is a convinence method to apply <code>offset</code> and <code>limit</code> using the page number.</p>
<p>[compare]</p>
<p>[lhs title=&quot;Without forPage&quot;]</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> page </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> request</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">input</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">page</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> limit </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">20</span></div><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> offset </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> page </span><span style="color: #89DDFF;">===</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">?</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">0</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> (page </span><span style="color: #89DDFF;">-</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">) </span><span style="color: #89DDFF;">*</span><span style="color: #A6ACCD;"> limit</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">posts</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">offset</span><span style="color: #A6ACCD;">(offset)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">limit</span><span style="color: #A6ACCD;">(limit)</span></div></code></pre>
</div>

<p>[/lhs]</p>
<p>[rhs title=&quot;With forPage&quot;]</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">posts</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">forPage</span><span style="color: #A6ACCD;">(request</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">input</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">page</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">20</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>[/rhs]
[/compare]</p>
<h2 id="aggregates"><a
  href="#aggregates"
  
  
><span class="icon icon-link"></span></a>
Aggregates</h2>
<p>The query builder supports of all the SQL aggregate methods as a first class citizen. The following examples uses the <code>count</code> aggregate, however the API remains the same for aggregate methods as well.</p>
<h3 id="count"><a
  href="#count"
  
  
><span class="icon icon-link"></span></a>
count</h3>
<p>The <code>count</code> method allows you to use the <strong>count aggregate</strong> in your SQL queries.</p>
<div class="alert alert-note"><p>The keys for the aggregate values are dialect specific and hence we recommend you to always define aliases for predictable output.</p></div>
<div class="alert alert-note"><p>In PostgreSQL, the count returns a bigint type which will be a <code>String</code> and not a <code>Number</code>.</p></div>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> users </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">await</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">count</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">* as total</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">console</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">log</span><span style="color: #A6ACCD;">(users[</span><span style="color: #F78C6C;">0</span><span style="color: #A6ACCD;">]</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">total)</span></div></code></pre>
</div>

<p>You can also define the aggregate as follows:</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> users </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">await</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">count</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">*</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">total</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">console</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">log</span><span style="color: #A6ACCD;">(users[</span><span style="color: #F78C6C;">0</span><span style="color: #A6ACCD;">]</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">total)</span></div></code></pre>
</div>

<p>You can count multiple columns as follows:</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> users </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">await</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">count</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">active</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">is_active</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">total</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">*</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">console</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">log</span><span style="color: #A6ACCD;">(users[</span><span style="color: #F78C6C;">0</span><span style="color: #A6ACCD;">]</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">total)</span></div><div class="line"><span style="color: #A6ACCD;">console</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">log</span><span style="color: #A6ACCD;">(users[</span><span style="color: #F78C6C;">0</span><span style="color: #A6ACCD;">]</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">active)</span></div></code></pre>
</div>

<p>Following is the list of other supported aggregate methods. The API is identical to the <code>count</code> method.</p>
<ul>
<li><code>countDistinct</code></li>
<li><code>min</code></li>
<li><code>max</code></li>
<li><code>sum</code></li>
<li><code>sumDistinct</code></li>
<li><code>avg</code></li>
<li><code>avgDistinct</code></li>
</ul>
<h2 id="union"><a
  href="#union"
  
  
><span class="icon icon-link"></span></a>
union</h2>
<p>The <code>union</code> method allows to you build up a union query by using multiple instances of the query builder. For example:</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereNull</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">last_name</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">union</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">    </span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereNull</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">first_name</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">  </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div><div class="line"></div><div class="line"><span style="color: #676E95;">/**</span></div><div class="line"><span style="color: #676E95;">SELECT * FROM &quot;users&quot; WHERE &quot;last_name&quot; IS NULL</span></div><div class="line"><span style="color: #676E95;">UNION</span></div><div class="line"><span style="color: #676E95;">SELECT * FROM &quot;users&quot; WHERE &quot;first_name&quot; IS NULL</span></div><div class="line"><span style="color: #676E95;">*/</span></div></code></pre>
</div>

<p>You can also wrap your union queries by passing a boolean flag as the 2nd argument.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereNull</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">last_name</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">union</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">    </span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereNull</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">first_name</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">  </span><span style="color: #89DDFF;">},</span><span style="color: #A6ACCD;"> </span><span style="color: #FF9CAC;">true</span><span style="color: #A6ACCD;">) </span><span style="color: #676E95;">// 👈</span></div><div class="line"></div><div class="line"><span style="color: #676E95;">/**</span></div><div class="line"><span style="color: #676E95;">SELECT * FROM &quot;users&quot; WHERE &quot;last_name&quot; IS NULL</span></div><div class="line"><span style="color: #676E95;">UNION</span></div><div class="line"><span style="color: #676E95;">(SELECT * FROM &quot;users&quot; WHERE &quot;first_name&quot; IS NULL)</span></div><div class="line"><span style="color: #676E95;">*/</span></div></code></pre>
</div>

<p>You can pass an array of callbacks to define multiple union queries.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  .from(&#x27;users&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">  .whereNull(&#x27;last_name&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">  .union([</span></div><div class="line"><span style="color: #A6ACCD;">    (query) =&gt; {</span></div><div class="line"><span style="color: #A6ACCD;">      query.from(&#x27;users&#x27;).whereNull(&#x27;first_name&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">    },</span></div><div class="line"><span style="color: #A6ACCD;">    (query) =&gt; {</span></div><div class="line"><span style="color: #A6ACCD;">      query.from(&#x27;users&#x27;).whereNull(&#x27;email&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">    },</span></div><div class="line"><span style="color: #A6ACCD;">  ], true)</span></div><div class="line"><span style="color: #A6ACCD;"></span></div><div class="line"><span style="color: #A6ACCD;">/**</span></div><div class="line"><span style="color: #A6ACCD;">SELECT * FROM &quot;users&quot; WHERE &quot;last_name&quot; IS NULL</span></div><div class="line"><span style="color: #A6ACCD;">UNION</span></div><div class="line"><span style="color: #A6ACCD;">(SELECT * FROM &quot;users&quot; WHERE &quot;first_name&quot; IS NULL)</span></div><div class="line"><span style="color: #A6ACCD;">UNION</span></div><div class="line"><span style="color: #A6ACCD;">(SELECT * FROM &quot;users&quot; WHERE &quot;email&quot; IS NULL)</span></div><div class="line"><span style="color: #A6ACCD;">*/</span></div></code></pre>
</div>

<p>Finally, you can also pass an instance of another query builder or a raw query to the <code>union</code> method.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  .from(&#x27;users&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">  .whereNull(&#x27;last_name&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">  .union([</span></div><div class="line"><span style="color: #A6ACCD;">    Database.from(&#x27;users&#x27;).whereNull(&#x27;first_name&#x27;),</span></div><div class="line"><span style="color: #A6ACCD;">    Database.from(&#x27;users&#x27;).whereNull(&#x27;email&#x27;)</span></div><div class="line"><span style="color: #A6ACCD;">  ], true)</span></div></code></pre>
</div>

<p>Following methods has the same API as the <code>union</code> method.</p>
<ul>
<li><code>unionAll</code></li>
<li><code>intersect</code></li>
</ul>
<h2 id="with"><a
  href="#with"
  
  
><span class="icon icon-link"></span></a>
with</h2>
<p>The <code>with</code> method allows you to make use of CTE (Common table expression) in PostgreSQL, Oracle, SQLite3 and MSSQL databases.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">query</span><span style="color: #A6ACCD;">()</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">with</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">aliased_table</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">    </span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">*</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">  </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">*</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">aliased_table</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"></div><div class="line"><span style="color: #676E95;">/**</span></div><div class="line"><span style="color: #676E95;">WITH &quot;aliased_table&quot; AS (</span></div><div class="line"><span style="color: #676E95;">  SELECT * FROM &quot;users&quot;</span></div><div class="line"><span style="color: #676E95;">)</span></div><div class="line"><span style="color: #676E95;">SELECT * FROM &quot;aliased_table&quot;</span></div><div class="line"><span style="color: #676E95;">*/</span></div></code></pre>
</div>

<h2 id="withrecursive"><a
  href="#withrecursive"
  
  
><span class="icon icon-link"></span></a>
withRecursive</h2>
<p>The <code>withRecursive</code> method creates a recursive CTE (Common table expression) in PostgreSQL, Oracle, SQLite3 and MSSQL databases.</p>
<p>In the following example, we calculate the sum of all children accounts of a parent account. Also, we assume the following table structure.</p>





















































<table><thead><tr><th>id</th><th>name</th><th>parent_id</th><th>amount</th></tr></thead><tbody><tr><td>1</td><td>Expenses</td><td>NULL</td><td>NULL</td></tr><tr><td>2</td><td>Car Expenses</td><td>1</td><td>100</td></tr><tr><td>3</td><td>Food Expenses</td><td>1</td><td>40</td></tr><tr><td>4</td><td>Earnings</td><td>NULL</td><td>NULL</td></tr><tr><td>5</td><td>Freelance work</td><td>4</td><td>100</td></tr><tr><td>6</td><td>Blog post payment</td><td>4</td><td>78</td></tr><tr><td>7</td><td>Car service</td><td>2</td><td>60</td></tr></tbody></table>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">query</span><span style="color: #A6ACCD;">()</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">withRecursive</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">tree</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">    </span><span style="color: #A6ACCD;">query</span></div><div class="line"><span style="color: #F07178;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">accounts</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">amount</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #F07178;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #F07178;"> </span><span style="color: #F78C6C;">1</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">      </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">union</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">subquery</span><span style="color: #89DDFF;">)</span><span style="color: #F07178;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #F07178;"> </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">        </span><span style="color: #A6ACCD;">subquery</span></div><div class="line"><span style="color: #F07178;">          </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">accounts as a</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">          </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">a.amount</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #F07178;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">a.id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">          </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">innerJoin</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">tree</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #F07178;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">tree.id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #F07178;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">=</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #F07178;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">a.parent_id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">      </span><span style="color: #89DDFF;">}</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">  </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">sum</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">amount as total</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">tree</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>The above example is not meant to simplify the complexity of SQL. Instead, it demonstrates the power of the query builder to construct such SQL queries without writing it as a SQL string.</p>
<p>Here&#x27;s a great article explaining the <a
  href="https://www.postgresqltutorial.com/postgresql-recursive-query/"
  target=&quot;_blank&quot;
  rel=&quot;noopener&quot;
>PostgreSQL Recursive Query</a>
</p>
<h2 id="update"><a
  href="#update"
  
  
><span class="icon icon-link"></span></a>
update</h2>
<p>The <code>update</code> method allows updating one or more database rows. You can make use of the query builder to add additional constraints when performing the update.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> affectedRows </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">update</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">{</span><span style="color: #A6ACCD;"> </span><span style="color: #F07178;">email</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">virk@adonisjs.com</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>The return value is the number of affected rows. However when using <code>PostgreSQL</code>, <code>Orcale</code> or <code>MSSQL</code>, you can specify the return columns as well.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> rows </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">update</span><span style="color: #A6ACCD;">(</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">{</span><span style="color: #A6ACCD;"> </span><span style="color: #F07178;">email</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">virk@adonisjs.com</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">},</span></div><div class="line"><span style="color: #A6ACCD;">    [</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">email</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">] </span><span style="color: #676E95;">// columns to return</span></div><div class="line"><span style="color: #A6ACCD;">  )</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">console</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">log</span><span style="color: #A6ACCD;">(rows[</span><span style="color: #F78C6C;">0</span><span style="color: #A6ACCD;">]</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">id)</span></div><div class="line"><span style="color: #A6ACCD;">console</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">log</span><span style="color: #A6ACCD;">(rows[</span><span style="color: #F78C6C;">0</span><span style="color: #A6ACCD;">]</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">email)</span></div></code></pre>
</div>

<h2 id="increment"><a
  href="#increment"
  
  
><span class="icon icon-link"></span></a>
increment</h2>
<p>The <code>increment</code> method allows incrementing the value for one or more columns.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">accounts</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">increment</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">balance</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">10</span><span style="color: #A6ACCD;">)</span></div><div class="line"></div><div class="line"><span style="color: #676E95;">/**</span></div><div class="line"><span style="color: #676E95;">UPDATE &quot;accounts&quot;</span></div><div class="line"><span style="color: #676E95;">SET</span></div><div class="line"><span style="color: #676E95;">  &quot;balance&quot; = &quot;balance&quot; + 10</span></div><div class="line"><span style="color: #676E95;">WHERE</span></div><div class="line"><span style="color: #676E95;">  &quot;id&quot; = 1</span></div><div class="line"><span style="color: #676E95;">*/</span></div></code></pre>
</div>

<p>You can also increment multiple columns by passing an object.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">accounts</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">increment</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #F07178;">balance</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">10</span><span style="color: #89DDFF;">,</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #F07178;">credit_limit</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">5</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div><div class="line"></div><div class="line"><span style="color: #676E95;">/**</span></div><div class="line"><span style="color: #676E95;">UPDATE &quot;accounts&quot;</span></div><div class="line"><span style="color: #676E95;">SET</span></div><div class="line"><span style="color: #676E95;">  &quot;balance&quot; = &quot;balance&quot; + 10,</span></div><div class="line"><span style="color: #676E95;">  &quot;credit_limit&quot; = &quot;credit_limit&quot; + 5</span></div><div class="line"><span style="color: #676E95;">WHERE</span></div><div class="line"><span style="color: #676E95;">  &quot;id&quot; = 1</span></div><div class="line"><span style="color: #676E95;">*/</span></div></code></pre>
</div>

<h2 id="decrement"><a
  href="#decrement"
  
  
><span class="icon icon-link"></span></a>
decrement</h2>
<p>The <code>decrement</code> method is opposite of the <code>increment</code> method. However, the API is same.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">accounts</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">decrement</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">balance</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">10</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<h2 id="delete"><a
  href="#delete"
  
  
><span class="icon icon-link"></span></a>
delete</h2>
<p>The <code>delete</code> method issues a <strong>delete</strong> SQL query. You can make use of the query builder to add additional constraints when performing the delete.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">delete</span><span style="color: #A6ACCD;">()</span></div></code></pre>
</div>

<p>The <code>delete</code> method also has an alias called <code>del</code>.</p>
<h2 id="paginate"><a
  href="#paginate"
  
  
><span class="icon icon-link"></span></a>
paginate</h2>
<h2 id="usetransaction"><a
  href="#usetransaction"
  
  
><span class="icon icon-link"></span></a>
useTransaction</h2>
<p>The <code>useTransaction</code> method instructs the query builder to wrap the query inside a transaction. The guide on <a
  href="/guides/database/transactions"
  
  
>database transactions</a>
 covers different ways to create and use transactions in your application.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> trx </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">await</span><span style="color: #A6ACCD;"> Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">transaction</span><span style="color: #A6ACCD;">()</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">useTransaction</span><span style="color: #A6ACCD;">(trx) </span><span style="color: #676E95;">// 👈</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">update</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">{</span><span style="color: #A6ACCD;"> </span><span style="color: #F07178;">email</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">virk@adonisjs.com</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<h3 id="forupdate"><a
  href="#forupdate"
  
  
><span class="icon icon-link"></span></a>
forUpdate</h3>
<p>The <code>forUpdate</code> method acquires an update lock on the selected rows in PostgreSQL and MySQL.</p>
<div class="alert alert-note"><p>Make sure to always supply the transaction object using the <code>useTransaction</code> method, before using <code>forUpdate</code> or similar locks.</p></div>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> user </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">useTransaction</span><span style="color: #A6ACCD;">(trx)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">forUpdate</span><span style="color: #A6ACCD;">() </span><span style="color: #676E95;">// 👈</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">first</span><span style="color: #A6ACCD;">()</span></div></code></pre>
</div>

<h3 id="forshare"><a
  href="#forshare"
  
  
><span class="icon icon-link"></span></a>
forShare</h3>
<p>The <code>forShare</code> adds a <strong>FOR SHARE in PostgreSQL</strong> and a <strong>LOCK IN SHARE MODE for MySQL</strong> during a select statement.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> user </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">useTransaction</span><span style="color: #A6ACCD;">(trx)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">forShare</span><span style="color: #A6ACCD;">() </span><span style="color: #676E95;">// 👈</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">first</span><span style="color: #A6ACCD;">()</span></div></code></pre>
</div>

<h3 id="skiplocked"><a
  href="#skiplocked"
  
  
><span class="icon icon-link"></span></a>
skipLocked</h3>
<p>The <code>skipLocked</code> method skips the rows locked by another transaction. The method is only supported by MySQL 8.0+ and PostgreSQL 9.5+.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">forUpdate</span><span style="color: #A6ACCD;">()</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">skipLocked</span><span style="color: #A6ACCD;">() </span><span style="color: #676E95;">// 👈</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">first</span><span style="color: #A6ACCD;">()</span></div><div class="line"></div><div class="line"><span style="color: #676E95;">/**</span></div><div class="line"><span style="color: #676E95;">SELECT * FROM &quot;users&quot;</span></div><div class="line"><span style="color: #676E95;">WHERE &quot;id&quot; = 1</span></div><div class="line"><span style="color: #676E95;">FOR UPDATE SKIP LOCKED</span></div><div class="line"><span style="color: #676E95;">*/</span></div></code></pre>
</div>

<h3 id="nowait"><a
  href="#nowait"
  
  
><span class="icon icon-link"></span></a>
noWait</h3>
<p>The <code>noWait</code> method results in a failure if any of the selected rows are locked by another transaction. The method is only supported by MySQL 8.0+ and PostgreSQL 9.5+.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">forUpdate</span><span style="color: #A6ACCD;">()</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">noWait</span><span style="color: #A6ACCD;">() </span><span style="color: #676E95;">// 👈</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">first</span><span style="color: #A6ACCD;">()</span></div><div class="line"></div><div class="line"><span style="color: #676E95;">/**</span></div><div class="line"><span style="color: #676E95;">SELECT * FROM &quot;users&quot;</span></div><div class="line"><span style="color: #676E95;">WHERE &quot;id&quot; = 1</span></div><div class="line"><span style="color: #676E95;">FOR UPDATE NOWAIT</span></div><div class="line"><span style="color: #676E95;">*/</span></div></code></pre>
</div>

<h2 id="clone"><a
  href="#clone"
  
  
><span class="icon icon-link"></span></a>
clone</h2>
<p>The <code>clone</code> method returns a new query builder object with all constraints applied from the original query.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> query </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">email</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> clonedQuery </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> query</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">clone</span><span style="color: #A6ACCD;">()</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">clearSelect</span><span style="color: #A6ACCD;">()</span></div><div class="line"></div><div class="line"><span style="color: #89DDFF;">await</span><span style="color: #A6ACCD;"> query </span><span style="color: #676E95;">// select &quot;id&quot;, &quot;email&quot; from &quot;users&quot;</span></div><div class="line"><span style="color: #89DDFF;">await</span><span style="color: #A6ACCD;"> clonedQuery </span><span style="color: #676E95;">// select * from &quot;users&quot;</span></div></code></pre>
</div>

<h2 id="debug"><a
  href="#debug"
  
  
><span class="icon icon-link"></span></a>
debug</h2>
<p>The <code>debug</code> method allows enabling or disabling debugging at an individual query level. Here&#x27;s a <a
  href="/guides/database/debugging-queries/"
  
  
>complete guide</a>
 on debugging queries.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">debug</span><span style="color: #A6ACCD;">(</span><span style="color: #FF9CAC;">true</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<h2 id="timeout"><a
  href="#timeout"
  
  
><span class="icon icon-link"></span></a>
timeout</h2>
<p>Define the <code>timeout</code> for the query. An exception is raised after the timeout has been exceeded.</p>
<p>The value of timeout is always in milliseconds.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">timeout</span><span style="color: #A6ACCD;">(</span><span style="color: #F78C6C;">2000</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>You can also cancel the query when using timeouts with MySQL and PostgreSQL.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">timeout</span><span style="color: #A6ACCD;">(</span><span style="color: #F78C6C;">2000</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">{</span><span style="color: #A6ACCD;"> </span><span style="color: #F07178;">cancel</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> </span><span style="color: #FF9CAC;">true</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<h2 id="tosql"><a
  href="#tosql"
  
  
><span class="icon icon-link"></span></a>
toSQL</h2>
<p>The <code>toSQL</code> method returns the query SQL and bindings as an object.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> output </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">toSQL</span><span style="color: #A6ACCD;">()</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">console</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">log</span><span style="color: #A6ACCD;">(output)</span></div></code></pre>
</div>

<p>The <code>toSQL</code> object also has <code>toNative</code> method to format the SQL query as per the database dialect in use.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> output </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">toSQL</span><span style="color: #A6ACCD;">()</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">toNative</span><span style="color: #A6ACCD;">()</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">console</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">log</span><span style="color: #A6ACCD;">(output)</span></div></code></pre>
</div>

<h2 id="toquery"><a
  href="#toquery"
  
  
><span class="icon icon-link"></span></a>
toQuery</h2>
<p>Returns the SQL query as a string with bindings applied to the placeholders.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> output </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">toQuery</span><span style="color: #A6ACCD;">()</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">console</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">log</span><span style="color: #A6ACCD;">(output)</span></div><div class="line"><span style="color: #676E95;">// select * from &quot;users&quot; where &quot;id&quot; = 1</span></div></code></pre>
</div>

<h2 id="execute-queries"><a
  href="#execute-queries"
  
  
><span class="icon icon-link"></span></a>
Execute queries</h2>
<p>The query builder extends the native <code>Promise</code> class. You can execute the queries using the <code>await</code> keyword or by chaining the <code>then/catch</code> methods.</p>
<p>Unlike native promises, the query builder is not eager in nature. It means, the query is not executed until you chain <code>then/catch</code> or make use of the <code>await keyword</code>.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">then</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">users</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">  </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">catch</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">error</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">  </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>Using async/await</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> users </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">await</span><span style="color: #A6ACCD;"> Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>Also, you can execute a query by explicitly calling the <code>exec</code> method.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> users </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">await</span><span style="color: #A6ACCD;"> Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">exec</span><span style="color: #A6ACCD;">()</span></div></code></pre>
</div>

<h3 id="first"><a
  href="#first"
  
  
><span class="icon icon-link"></span></a>
first</h3>
<p>The select queries always returns an array of objects, even when the query is intended to fetch a single row. However, using the <code>first</code> method will give you first row or null (when there are no rows).</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> user </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">await</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">first</span><span style="color: #A6ACCD;">()</span></div><div class="line"></div><div class="line"><span style="color: #89DDFF;">if</span><span style="color: #A6ACCD;"> (user) </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">  </span><span style="color: #A6ACCD;">console</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">log</span><span style="color: #F07178;">(</span><span style="color: #A6ACCD;">user</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">id</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #89DDFF;">}</span></div></code></pre>
</div>

<h3 id="firstorfail"><a
  href="#firstorfail"
  
  
><span class="icon icon-link"></span></a>
firstOrFail</h3>
<p>The <code>firstOrFail</code> method is similar to the <code>first</code> method except, it raises an exception when no rows are found.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> user </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">await</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">firstOrFail</span><span style="color: #A6ACCD;">()</span></div></code></pre>
</div>

<h2 id="pagination"><a
  href="#pagination"
  
  
><span class="icon icon-link"></span></a>
Pagination</h2>
<p>The query builder has first class support for offset based pagination. It also automatically counts the number of total rows by running a separate query behind the scenes.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> page </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> request</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">input</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">page</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> limit </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">20</span></div><div class="line"></div><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> results </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">await</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">paginate</span><span style="color: #A6ACCD;">(page</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> limit)</span></div></code></pre>
</div>

<p>The <code>paginate</code> method returns an instance of the <a
  href="https://github.com/adonisjs/lucid/blob/efed38908680cca3b288d9b2a123586fab155b1d/src/Database/Paginator/SimplePaginator.ts#L20"
  target=&quot;_blank&quot;
  rel=&quot;noopener&quot;
>SimplePaginator</a>
 class. The class has following properties and methods.</p>
<h3 id="firstpage"><a
  href="#firstpage"
  
  
><span class="icon icon-link"></span></a>
firstPage</h3>
<p>Returns the number for the first page. It is always <code>1</code>.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">results</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">firstPage</span></div></code></pre>
</div>

<h3 id="perpage"><a
  href="#perpage"
  
  
><span class="icon icon-link"></span></a>
perPage</h3>
<p>Returns the value for the limit passed to the <code>paginate</code> method.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">results</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">perPage</span></div></code></pre>
</div>

<h3 id="currentpage"><a
  href="#currentpage"
  
  
><span class="icon icon-link"></span></a>
currentPage</h3>
<p>Returns the value for the current page.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">results</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">currentPage</span></div></code></pre>
</div>

<h3 id="lastpage"><a
  href="#lastpage"
  
  
><span class="icon icon-link"></span></a>
lastPage</h3>
<p>Returns the value for the last page by taking the total of rows into account.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">results</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">lastPage</span></div></code></pre>
</div>

<h3 id="total"><a
  href="#total"
  
  
><span class="icon icon-link"></span></a>
total</h3>
<p>Holds the value for the total number of rows in the database.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">results</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">total</span></div></code></pre>
</div>

<h3 id="haspages"><a
  href="#haspages"
  
  
><span class="icon icon-link"></span></a>
hasPages</h3>
<p>A boolean to know if there are pages for pagination. You can rely on this value to decide when or when not to show the pagination links.</p>
<p>Following is an example of the edge view</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #89DDFF;">@if</span><span style="color: #A6ACCD;">(results</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">hasPages)</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #676E95;">{{-- Display pagination links --}}</span></div><div class="line"></div><div class="line"><span style="color: #89DDFF;">@endif</span></div></code></pre>
</div>

<h3 id="hasmorepages"><a
  href="#hasmorepages"
  
  
><span class="icon icon-link"></span></a>
hasMorePages</h3>
<p>A boolean to know if there are more pages to go after the current page.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">results</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">hasMorePages</span></div></code></pre>
</div>

<h3 id="all"><a
  href="#all"
  
  
><span class="icon icon-link"></span></a>
all()</h3>
<p>Returns an array of rows returned by the SQL queries.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">results</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">all</span><span style="color: #A6ACCD;">()</span></div></code></pre>
</div>

<h3 id="geturl"><a
  href="#geturl"
  
  
><span class="icon icon-link"></span></a>
getUrl</h3>
<p>Returns the number for a given page number.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">result</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">getUrl</span><span style="color: #A6ACCD;">(</span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">) </span><span style="color: #676E95;">// /?page=1</span></div></code></pre>
</div>

<h3 id="getnextpageurl"><a
  href="#getnextpageurl"
  
  
><span class="icon icon-link"></span></a>
getNextPageUrl</h3>
<p>Returns the url for the next page</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #676E95;">// Assuming the current page is 2</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">result</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">getNextPageUrl</span><span style="color: #A6ACCD;">() </span><span style="color: #676E95;">// /?page=3</span></div></code></pre>
</div>

<h3 id="getpreviouspageurl"><a
  href="#getpreviouspageurl"
  
  
><span class="icon icon-link"></span></a>
getPreviousPageUrl</h3>
<p>Returns the url for the previous page</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #676E95;">// Assuming the current page is 2</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">result</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">getPreviousPageUrl</span><span style="color: #A6ACCD;">() </span><span style="color: #676E95;">// /?page=1</span></div></code></pre>
</div>

<h3 id="geturlsforrange"><a
  href="#geturlsforrange"
  
  
><span class="icon icon-link"></span></a>
getUrlsForRange</h3>
<p>Returns urls for a given range. Helpful when you want to render links for a given range.</p>
<p>Following is an example of the edge template</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #89DDFF;">@</span><span style="color: #82AAFF;">each</span><span style="color: #A6ACCD;">(link </span><span style="color: #89DDFF;">in</span><span style="color: #A6ACCD;"> results</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">getUrlsForRange</span><span style="color: #A6ACCD;">(results</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">firstPage</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> results</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">lastPage))</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">&lt;</span><span style="color: #A6ACCD;">a</span></div><div class="line"><span style="color: #A6ACCD;">    href</span><span style="color: #89DDFF;">=</span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">{{ link.url }}</span><span style="color: #89DDFF;">&quot;</span></div><div class="line"><span style="color: #A6ACCD;">    class</span><span style="color: #89DDFF;">=</span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">{{ link.isActive ? &#x27;active&#x27; : &#x27;&#x27; }}</span><span style="color: #89DDFF;">&quot;</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">&gt;</span></div><div class="line"><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">{{</span><span style="color: #F07178;"> </span><span style="color: #A6ACCD;">link</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">page</span><span style="color: #F07178;"> </span><span style="color: #89DDFF;">}}</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">&lt;/</span><span style="color: #A6ACCD;">a</span><span style="color: #89DDFF;">&gt;</span></div><div class="line"><span style="color: #89DDFF;">@</span><span style="color: #A6ACCD;">endeach</span></div></code></pre>
</div>

<h3 id="tojson"><a
  href="#tojson"
  
  
><span class="icon icon-link"></span></a>
toJSON</h3>
<p>The <code>toJSON</code> method returns an object with <code>meta</code> and <code>data</code> properties. The output of the method is suitable for JSON API responses.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">results</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">toJSON</span><span style="color: #A6ACCD;">()</span></div><div class="line"></div><div class="line"><span style="color: #676E95;">/**</span></div><div class="line"><span style="color: #676E95;">{</span></div><div class="line"><span style="color: #676E95;">  meta: {</span></div><div class="line"><span style="color: #676E95;">    total: 200,</span></div><div class="line"><span style="color: #676E95;">    per_page: 20,</span></div><div class="line"><span style="color: #676E95;">    current_page: 1,</span></div><div class="line"><span style="color: #676E95;">    first_page: 1,</span></div><div class="line"><span style="color: #676E95;">    last_page: 20,</span></div><div class="line"><span style="color: #676E95;">    ...</span></div><div class="line"><span style="color: #676E95;">  },</span></div><div class="line"><span style="color: #676E95;">  data: [</span></div><div class="line"><span style="color: #676E95;">    {</span></div><div class="line"><span style="color: #676E95;">    }</span></div><div class="line"><span style="color: #676E95;">  ]</span></div><div class="line"><span style="color: #676E95;">}</span></div><div class="line"><span style="color: #676E95;">*/</span></div></code></pre>
</div>

<h3 id="baseurl"><a
  href="#baseurl"
  
  
><span class="icon icon-link"></span></a>
baseUrl</h3>
<p>All of the URLs generated by the paginator class uses the <code>/</code> (root) URL. However, you can change this defining a custom base url.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">results</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">baseUrl</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">/posts</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">results</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">getUrl</span><span style="color: #A6ACCD;">(</span><span style="color: #F78C6C;">2</span><span style="color: #A6ACCD;">) </span><span style="color: #676E95;">// /posts?page=2</span></div></code></pre>
</div>

<h3 id="querystring"><a
  href="#querystring"
  
  
><span class="icon icon-link"></span></a>
queryString</h3>
<p>Define query string to be appended to the URLs generated by the paginator class.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">results</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">queryString</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">{</span><span style="color: #A6ACCD;"> </span><span style="color: #F07178;">limit</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">20</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F07178;">sort</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">top</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">results</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">getUrl</span><span style="color: #A6ACCD;">(</span><span style="color: #F78C6C;">2</span><span style="color: #A6ACCD;">) </span><span style="color: #676E95;">// /?page=2&amp;limit=20&amp;sort=top</span></div></code></pre>
</div>

<h2 id="helpful-properties-and-methods"><a
  href="#helpful-properties-and-methods"
  
  
><span class="icon icon-link"></span></a>
Helpful properties and methods</h2>
<p>Following is the list of properties and methods that you may need occasionally when trying build something on top of the query builder.</p>
<h3 id="client"><a
  href="#client"
  
  
><span class="icon icon-link"></span></a>
client</h3>
<p>Reference to the instance of the underlying <a
  href="/api/database/query-client"
  
  
>database query client</a>
.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> query </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">query</span><span style="color: #A6ACCD;">()</span></div><div class="line"><span style="color: #A6ACCD;">console</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">log</span><span style="color: #A6ACCD;">(query</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">client)</span></div></code></pre>
</div>

<h3 id="knexquery"><a
  href="#knexquery"
  
  
><span class="icon icon-link"></span></a>
knexQuery</h3>
<p>Reference to the instance of the underlying KnexJS query.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> query </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">query</span><span style="color: #A6ACCD;">()</span></div><div class="line"><span style="color: #A6ACCD;">console</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">log</span><span style="color: #A6ACCD;">(query</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">knexQuery)</span></div></code></pre>
</div>

<h3 id="hasaggregates"><a
  href="#hasaggregates"
  
  
><span class="icon icon-link"></span></a>
hasAggregates</h3>
<p>A boolean to know if query is using any of the aggregate methods.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> query </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">posts</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">count</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">* as total</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">console</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">log</span><span style="color: #A6ACCD;">(query</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">hasAggregates) </span><span style="color: #676E95;">// true</span></div></code></pre>
</div>

<h3 id="hasgroupby"><a
  href="#hasgroupby"
  
  
><span class="icon icon-link"></span></a>
hasGroupBy</h3>
<p>A boolean to know if query is using a group by clause.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> query </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">posts</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">groupBy</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">tenant_id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">console</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">log</span><span style="color: #A6ACCD;">(query</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">hasGroupBy) </span><span style="color: #676E95;">// true</span></div></code></pre>
</div>

<h3 id="hasunion"><a
  href="#hasunion"
  
  
><span class="icon icon-link"></span></a>
hasUnion</h3>
<p>A boolean to know if query is using a union.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> query </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereNull</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">last_name</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">union</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">    </span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">whereNull</span><span style="color: #F07178;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">first_name</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #F07178;">  </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div><div class="line"></div><div class="line"><span style="color: #A6ACCD;">console</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">log</span><span style="color: #A6ACCD;">(query</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">hasUnion) </span><span style="color: #676E95;">// true</span></div></code></pre>
</div>

<h3 id="clearselect"><a
  href="#clearselect"
  
  
><span class="icon icon-link"></span></a>
clearSelect</h3>
<p>Call this method to clear selected columns.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> query </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">query</span><span style="color: #A6ACCD;">()</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">title</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">clone</span><span style="color: #A6ACCD;">()</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">clearSelect</span><span style="color: #A6ACCD;">()</span></div></code></pre>
</div>

<h3 id="clearwhere"><a
  href="#clearwhere"
  
  
><span class="icon icon-link"></span></a>
clearWhere</h3>
<p>Call this method to clear where clauses.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> query </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">query</span><span style="color: #A6ACCD;">()</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">where</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">clone</span><span style="color: #A6ACCD;">()</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">clearWhere</span><span style="color: #A6ACCD;">()</span></div></code></pre>
</div>

<h3 id="clearorder"><a
  href="#clearorder"
  
  
><span class="icon icon-link"></span></a>
clearOrder</h3>
<p>Call this method to clear the order by constraint.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> query </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">query</span><span style="color: #A6ACCD;">()</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">orderBy</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">id</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">desc</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">clone</span><span style="color: #A6ACCD;">()</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">clearOrder</span><span style="color: #A6ACCD;">()</span></div></code></pre>
</div>

<h3 id="clearhaving"><a
  href="#clearhaving"
  
  
><span class="icon icon-link"></span></a>
clearHaving</h3>
<p>Call this method to clear the having clause.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> query </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">query</span><span style="color: #A6ACCD;">()</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">having</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">total</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">&gt;</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">100</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">clone</span><span style="color: #A6ACCD;">()</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">clearHaving</span><span style="color: #A6ACCD;">()</span></div></code></pre>
</div>

<h3 id="clearlimit"><a
  href="#clearlimit"
  
  
><span class="icon icon-link"></span></a>
clearLimit</h3>
<p>Call this method to clear the applied limit.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> query </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">query</span><span style="color: #A6ACCD;">()</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">limit</span><span style="color: #A6ACCD;">(</span><span style="color: #F78C6C;">20</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">clone</span><span style="color: #A6ACCD;">()</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">clearLimit</span><span style="color: #A6ACCD;">()</span></div></code></pre>
</div>

<h3 id="clearoffset"><a
  href="#clearoffset"
  
  
><span class="icon icon-link"></span></a>
clearOffset</h3>
<p>Call this method to clear the applied offset.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> query </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">query</span><span style="color: #A6ACCD;">()</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">offset</span><span style="color: #A6ACCD;">(</span><span style="color: #F78C6C;">20</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">clone</span><span style="color: #A6ACCD;">()</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">clearOffset</span><span style="color: #A6ACCD;">()</span></div></code></pre>
</div>

<h3 id="reporterdata"><a
  href="#reporterdata"
  
  
><span class="icon icon-link"></span></a>
reporterData</h3>
<p>The query builder emits the <code>db:query</code> event and also reports the queries execution time with the framework profiler.</p>
<p>Using the <code>reporterData</code> method, you can pass additional details to the event and the profiler.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #C792EA;">const</span><span style="color: #A6ACCD;"> query </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> Database</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">from</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">users</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div><div class="line"></div><div class="line"><span style="color: #89DDFF;">await</span><span style="color: #A6ACCD;"> query</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">reporterData</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">{</span><span style="color: #A6ACCD;"> </span><span style="color: #F07178;">userId</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> auth</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">user</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">id </span><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div><div class="line"><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">select</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">*</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>

<p>Now within the <code>db:query</code> event, you can access the value of <code>userId</code> as follows.</p>
<div class="dimer-highlight">

<pre><code><div class="line"><span style="color: #A6ACCD;">Event</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">on</span><span style="color: #A6ACCD;">(</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #C3E88D;">db:query</span><span style="color: #89DDFF;">&#x27;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">(</span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span><span style="color: #C792EA;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">{</span></div><div class="line"><span style="color: #F07178;">  </span><span style="color: #A6ACCD;">console</span><span style="color: #89DDFF;">.</span><span style="color: #82AAFF;">log</span><span style="color: #F07178;">(</span><span style="color: #A6ACCD;">query</span><span style="color: #89DDFF;">.</span><span style="color: #A6ACCD;">userId</span><span style="color: #F07178;">)</span></div><div class="line"><span style="color: #89DDFF;">}</span><span style="color: #A6ACCD;">)</span></div></code></pre>
</div>
  </div>
</main>

<aside class="toc">
    <div class="toc-container" data-turbo="false">
      <h3> On this page </h3>
      <nav>
        <ul>
<li>
<p><a
  href="#select"
  
  
>select</a>
</p>
</li>
<li>
<p><a
  href="#from"
  
  
>from</a>
</p>
</li>
<li>
<p><a
  href="#where"
  
  
>where</a>
</p>
</li>
<li>
<p><a
  href="#wherein"
  
  
>whereIn</a>
</p>
</li>
<li>
<p><a
  href="#whereexists"
  
  
>whereExists</a>
</p>
</li>
<li>
<p><a
  href="#wherebetween"
  
  
>whereBetween</a>
</p>
</li>
<li>
<p><a
  href="#whereraw"
  
  
>whereRaw</a>
</p>
</li>
<li>
<p><a
  href="#join"
  
  
>join</a>
</p>
</li>
<li>
<p><a
  href="#joinraw"
  
  
>joinRaw</a>
</p>
</li>
<li>
<p><a
  href="#on-methods"
  
  
>On methods</a>
</p>
</li>
<li>
<p><a
  href="#having"
  
  
>having</a>
</p>
</li>
<li>
<p><a
  href="#distinct"
  
  
>distinct</a>
</p>
</li>
<li>
<p><a
  href="#groupby"
  
  
>groupBy</a>
</p>
</li>
<li>
<p><a
  href="#orderby"
  
  
>orderBy</a>
</p>
</li>
<li>
<p><a
  href="#offset"
  
  
>offset</a>
</p>
</li>
<li>
<p><a
  href="#limit"
  
  
>limit</a>
</p>
</li>
<li>
<p><a
  href="#forpage"
  
  
>forPage</a>
</p>
</li>
<li>
<p><a
  href="#aggregates"
  
  
>Aggregates</a>
</p>
<ul>
<li><a
  href="#count"
  
  
>count</a>
</li>
</ul>
</li>
<li>
<p><a
  href="#union"
  
  
>union</a>
</p>
</li>
<li>
<p><a
  href="#with"
  
  
>with</a>
</p>
</li>
<li>
<p><a
  href="#withrecursive"
  
  
>withRecursive</a>
</p>
</li>
<li>
<p><a
  href="#update"
  
  
>update</a>
</p>
</li>
<li>
<p><a
  href="#increment"
  
  
>increment</a>
</p>
</li>
<li>
<p><a
  href="#decrement"
  
  
>decrement</a>
</p>
</li>
<li>
<p><a
  href="#delete"
  
  
>delete</a>
</p>
</li>
<li>
<p><a
  href="#paginate"
  
  
>paginate</a>
</p>
</li>
<li>
<p><a
  href="#usetransaction"
  
  
>useTransaction</a>
</p>
<ul>
<li><a
  href="#forupdate"
  
  
>forUpdate</a>
</li>
<li><a
  href="#forshare"
  
  
>forShare</a>
</li>
<li><a
  href="#skiplocked"
  
  
>skipLocked</a>
</li>
<li><a
  href="#nowait"
  
  
>noWait</a>
</li>
</ul>
</li>
<li>
<p><a
  href="#clone"
  
  
>clone</a>
</p>
</li>
<li>
<p><a
  href="#debug"
  
  
>debug</a>
</p>
</li>
<li>
<p><a
  href="#timeout"
  
  
>timeout</a>
</p>
</li>
<li>
<p><a
  href="#tosql"
  
  
>toSQL</a>
</p>
</li>
<li>
<p><a
  href="#toquery"
  
  
>toQuery</a>
</p>
</li>
<li>
<p><a
  href="#execute-queries"
  
  
>Execute queries</a>
</p>
<ul>
<li><a
  href="#first"
  
  
>first</a>
</li>
<li><a
  href="#firstorfail"
  
  
>firstOrFail</a>
</li>
</ul>
</li>
<li>
<p><a
  href="#pagination"
  
  
>Pagination</a>
</p>
<ul>
<li><a
  href="#firstpage"
  
  
>firstPage</a>
</li>
<li><a
  href="#perpage"
  
  
>perPage</a>
</li>
<li><a
  href="#currentpage"
  
  
>currentPage</a>
</li>
<li><a
  href="#lastpage"
  
  
>lastPage</a>
</li>
<li><a
  href="#total"
  
  
>total</a>
</li>
<li><a
  href="#haspages"
  
  
>hasPages</a>
</li>
<li><a
  href="#hasmorepages"
  
  
>hasMorePages</a>
</li>
<li><a
  href="#all"
  
  
>all()</a>
</li>
<li><a
  href="#geturl"
  
  
>getUrl</a>
</li>
<li><a
  href="#getnextpageurl"
  
  
>getNextPageUrl</a>
</li>
<li><a
  href="#getpreviouspageurl"
  
  
>getPreviousPageUrl</a>
</li>
<li><a
  href="#geturlsforrange"
  
  
>getUrlsForRange</a>
</li>
<li><a
  href="#tojson"
  
  
>toJSON</a>
</li>
<li><a
  href="#baseurl"
  
  
>baseUrl</a>
</li>
<li><a
  href="#querystring"
  
  
>queryString</a>
</li>
</ul>
</li>
<li>
<p><a
  href="#helpful-properties-and-methods"
  
  
>Helpful properties and methods</a>
</p>
<ul>
<li><a
  href="#client"
  
  
>client</a>
</li>
<li><a
  href="#knexquery"
  
  
>knexQuery</a>
</li>
<li><a
  href="#hasaggregates"
  
  
>hasAggregates</a>
</li>
<li><a
  href="#hasgroupby"
  
  
>hasGroupBy</a>
</li>
<li><a
  href="#hasunion"
  
  
>hasUnion</a>
</li>
<li><a
  href="#clearselect"
  
  
>clearSelect</a>
</li>
<li><a
  href="#clearwhere"
  
  
>clearWhere</a>
</li>
<li><a
  href="#clearorder"
  
  
>clearOrder</a>
</li>
<li><a
  href="#clearhaving"
  
  
>clearHaving</a>
</li>
<li><a
  href="#clearlimit"
  
  
>clearLimit</a>
</li>
<li><a
  href="#clearoffset"
  
  
>clearOffset</a>
</li>
<li><a
  href="#reporterdata"
  
  
>reporterData</a>
</li>
</ul>
</li>
        </ul>
      </nav>
    </div>
</aside>

</body>
</html>